@model LaundryShopSystem.Models.Order
@{
    ViewBag.Title = "Create Order";
}
<div class="card card-strong p-4">
    <h4 class="accent">Create New Order</h4>

    <form method="post" action="/Orders/Create">
        <div class="row g-3">
            <div class="col-md-6">
                <label class="form-label">Customer (Phone)</label>
                <input name="Phone" class="form-control" placeholder="09104718041" required />
                
            </div>

            <div class="col-md-3">
                <label class="form-label">Service Mode</label>
                <select name="ServiceMode" class="form-select">
                    <option>Regular</option>
                    <option>Rush</option>
                </select>
            </div>

            <div class="col-md-3">
                <label class="form-label">Notes (optional)</label>
                <input name="Notes" class="form-control" />
            </div>

            <div class="col-12 mt-3">
                <h6>Items</h6>
                <div id="itemsContainer">
                    <div class="row g-2 align-items-end item-row">
                        <div class="col-md-3">
                            <label class="form-label">Item Type</label>
                            <input name="Items[0].ItemType" class="form-control" value="Clothes" />
                        </div>
                        <div class="col-md-2">
                            <label class="form-label">Quantity</label>
                            <input name="Items[0].Quantity" type="number" step="0.01" class="form-control" value="1" />
                        </div>
                        <div class="col-md-2">
                            <label class="form-label">Unit</label>
                            <select name="Items[0].UnitType" class="form-select">
                                <option>Kilo</option>
                                <option>Piece</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <label class="form-label">Service</label>
                            <select name="Items[0].ServiceType" class="form-select">
                                <option>Wash</option>
                                <option>Dry</option>
                                <option>Fold</option>
                                <option>Iron</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <label class="form-label">Price per unit</label>
                            <input name="Items[0].PricePerUnit" type="number" step="0.01" class="form-control" value="100" />
                        </div>
                        <div class="col-md-1">
                            <button type="button" class="btn btn-danger remove-item">×</button>
                        </div>
                    </div>
                </div>

                <button type="button" id="addItem" class="btn btn-outline-primary btn-sm mt-2">Add item</button>
            </div>

            <div class="col-12 text-end mt-3">
                <button type="submit" class="btn btn-primary">Create Order & Generate Receipt</button>
            </div>
        </div>
    </form>
</div>

@section Scripts {
    <script>
    let itemIndex = 1;
    document.getElementById('addItem').addEventListener('click', function(){
        const container = document.getElementById('itemsContainer');
        const html = `<div class="row g-2 align-items-end item-row">
            <div class="col-md-3"><label class="form-label">Item Type</label><input name="Items[${itemIndex}].ItemType" class="form-control" value="Clothes" /></div>
            <div class="col-md-2"><label class="form-label">Quantity</label><input name="Items[${itemIndex}].Quantity" type="number" step="0.01" class="form-control" value="1" /></div>
            <div class="col-md-2"><label class="form-label">Unit</label><select name="Items[${itemIndex}].UnitType" class="form-select"><option>Kilo</option><option>Piece</option></select></div>
            <div class="col-md-2"><label class="form-label">Service</label><select name="Items[${itemIndex}].ServiceType" class="form-select"><option>Wash</option><option>Dry</option><option>Fold</option><option>Iron</option></select></div>
            <div class="col-md-2"><label class="form-label">Price per unit</label><input name="Items[${itemIndex}].PricePerUnit" type="number" step="0.01" class="form-control" value="100" /></div>
            <div class="col-md-1"><button type="button" class="btn btn-danger remove-item">×</button></div>
        </div>`;
        container.insertAdjacentHTML('beforeend', html);
        itemIndex++;
    });

    document.addEventListener('click', function(e){
        if(e.target && e.target.classList.contains('remove-item')){
            e.target.closest('.item-row').remove();
        }
    });
    </script>
}
